-- Papita Aimbot v3 - Totalmente compatible
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

local aimbotEnabled = false
local targetPart = "Head"

-- GUI Panel Azul
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "PapitaAimbotGUI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 300, 0, 120)
frame.Position = UDim2.new(0.5, -150, 0.1, 0)
frame.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
frame.Active = true
frame.Draggable = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 40)
title.Text = "Papita Aimbot v3"
title.Font = Enum.Font.GothamBold
title.TextScaled = true
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundTransparency = 1

local statusLabel = Instance.new("TextLabel", frame)
statusLabel.Position = UDim2.new(0, 0, 0, 45)
statusLabel.Size = UDim2.new(1, 0, 1, -45)
statusLabel.Text = "Presiona [Z] para ACTIVAR\nPresiona [C] para DESACTIVAR"
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextScaled = true
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.BackgroundTransparency = 1
statusLabel.TextWrapped = true

-- Buscar jugador más cercano
local function getClosestTarget()
	local closest = nil
	local shortestDistance = math.huge
	local screenCenter = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)

	for _, player in ipairs(Players:GetPlayers()) do
		if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild(targetPart) then
			local part = player.Character[targetPart]
			local screenPos, onScreen = Camera:WorldToViewportPoint(part.Position)

			if onScreen then
				local dist = (Vector2.new(screenPos.X, screenPos.Y) - screenCenter).Magnitude
				if dist < shortestDistance then
					shortestDistance = dist
					closest = part
				end
			end
		end
	end

	return closest
end

-- Apuntar con la cámara
local function aimAt(part)
	if part then
		Camera.CFrame = CFrame.new(Camera.CFrame.Position, part.Position)
	end
end

-- Teclas para activar/desactivar
UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end

	if input.KeyCode == Enum.KeyCode.Z then
		aimbotEnabled = true
		statusLabel.Text = "Aimbot ACTIVADO\nPresiona [C] para desactivar"
	elseif input.KeyCode == Enum.KeyCode.C then
		aimbotEnabled = false
		statusLabel.Text = "Aimbot DESACTIVADO\nPresiona [Z] para activar"
	end
end)

-- Loop de aimbot
RunService.RenderStepped:Connect(function()
	if aimbotEnabled then
		local target = getClosestTarget()
		if target then
			aimAt(target)
		end
	end
end)
